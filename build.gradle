/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'java'
    id 'maven-publish'
    // id "com.github.johnrengelman.shadow" version "6.0.0"
}

repositories {
    mavenLocal()
    maven {
        url = uri('https://mirrors.tencent.com/nexus/repository/maven-public/')
    }
    maven {
        url = uri('http://maven.aliyun.com/nexus/content/groups/public/')
    }
    maven {
        url = uri('http://repo.maven.apache.org/maven2')
    }
}

dependencies {
    implementation 'commons-cli:commons-cli:1.4'
    implementation 'commons-codec:commons-codec:1.14'
    implementation 'org.apache.logging.log4j:log4j-api:2.13.3'
    implementation 'org.apache.logging.log4j:log4j-core:2.13.3'
    implementation 'org.ini4j:ini4j:0.5.4'
    implementation 'org.msgpack:msgpack-core:0.8.20'
    implementation 'org.json:json:20200518'
    implementation 'com.google.protobuf:protobuf-java:3.12.1'
    implementation 'org.apache.xmlbeans:xmlbeans:3.1.0'
    implementation 'org.apache.poi:poi-ooxml:4.1.2'
    implementation 'org.apache.poi:poi:4.1.2'
    implementation 'dom4j:dom4j:1.6.1'
    implementation 'org.apache.commons:commons-csv:1.8'
}

group = 'org.xresloader'
version = '2.9.1'
description = 'xresloader'
sourceCompatibility = '1.8'

publishing {
    publications {
        maven(MavenPublication) {
            from(components.java)
        }
    }
}

tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
}

task updateProtocols(type:Exec) {
  workingDir 'tools'

  //on windows:
  commandLine 'cmd', '/c', 'stop.bat'

  //on linux
  commandLine './stop.sh'

  //store the output instead of printing to the console:
  standardOutput = new ByteArrayOutputStream()

  //extension method stopTomcat.output() can be used to obtain the output:
  ext.output = {
    return standardOutput.toString()
  }
}
